"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[25146],{192784:(t,e,s)=>{s.r(e),s.d(e,{flushDelegate:()=>i});const i=new(s(707957).Delegate)},62802:(t,e,s)=>{t=s.nmd(t),s(638456);var i=s(120780).fetch,n=s(868073).regExpEscape,r=s(226722).TVXWindowEvents,a=s(49437).TVLocalStorage,o=s(707957).Delegate,l=s(244842),h=s(125226).isFeatureEnabled,{flushDelegate:u}=s(192784),d=s(201089).getLogger("Lib.TVSettings"),c=["s.tradingview.com","betacdn.tradingview.com"],_=(l.enabled("use_localstorage_for_settings"),window.TVSettings=function(){var t=!1,e=null,s=!1;function m(){return!(e||window.is_authenticated)}try{t=!TradingView.onWidget()&&parent&&parent!==window&&!!parent.IS_DEMO_PAGE}catch(t){}if(t){var g={"widgetbar.layout-settings":{widgets:{},settings:{minimized:!0}},notShowMainWizard:!0},p=function(t,e,s){var i=g[t];return null==i?e:i},f=function(){};return{loaded:!1,loadedModel:!1,getValue:p,getJSON:p,getBool:p,getFloat:p,getInt:p,setValue:f,setJSON:f,remove:f,keys:function(){return Object.keys(g)},keysMask:function(){return[]},sync:f,onSync:{subscribe:function(){}}}}var v=12e4;"local"===window.environment&&(v=5e3);var b,y,w,S=TradingView.onWidget()?"tradingview-widget":"tradingview",x=S+".",I={},k=[],M=[/^widgetbar\.widget\.watchlist.+/,/.+quicks$/,/^widgetbar\.layout-settings$/,/^ChartSideToolbarWidget\.visible$/,/^onwidget\.watchlist$/,/^chart\.favoriteDrawings$/,/^chart\.favoriteDrawingsPosition$/,/^chart\.favoriteLibraryIndicators$/,/^loadChartDialog.favorites$/,/^ChartFavoriteDrawingToolbarWidget\.visible/,/^trading\.chart\.proterty$/,/^trading_floating_toolbar\.position$/,/^trading\.orderWidgetMode\./,/^symbolWatermark$/,/^pinereference\.size$/,/^pinereference\.position$/,/^hint\.+/,/^ChartDrawingToolbarWidget\.visible/];function C(t){return x+t}function E(t){return t.substring(x.length)}function N(t,e){var s=I[t];return null==s?e:s}function T(t,e,s){s=s||{};var i=""+e;return I[t]!==i&&(I[t]=i,R(t)),s.forceFlush&&!y&&(y=setTimeout((function(){y=void 0,B()}),10)),_}function D(t,e){return e=e||{},null!=I[t]&&(delete I[t],R(t)),e.forceFlush&&B(),_}function P(){b=void 0,k.length&&B()}function R(t){if(e)null==I[t]?e.removeValue(t):e.setValue(t,I[t]);else if(m())try{null==I[t]?a.removeItem(C(t)):a.setItem(C(t),I[t])}catch(t){}else k.push(t),b||(b=setTimeout(P,v));r.emit("settings",JSON.stringify({key:t,value:I[t]}))}function B(t){if(!s&&!w)if(h("disable_save_settings"))d.logWarn("Settings flashing has been skipped because of disable_save_settings featuretoggle");else if(!l.enabled("widget")&&!m()&&0!==k.length){var e=k;k=[];for(var n={},r=e.length;r--;){var a=e[r],o=I[a];void 0===o&&(o=null),n[a]=o}var u=new FormData;u.append("delta",JSON.stringify(n)),t&&navigator.sendBeacon?navigator.sendBeacon("/savesettings/",u):i("/savesettings/",{method:"POST",credentials:"include",body:u}).then((function(s){if(s.ok||(k=k.concat(e)),[429,503].includes(s.status)){var i=1e3*+s.headers.get("retry-after")||3e5;w=setTimeout((()=>{w=void 0,B(t)}),i)}})).catch((function(){k=k.concat(e)}))}}function L(){
return Object.keys(I)}function $(t){for(var e=0;e<M.length;++e)if(M[e].exec(t))return!0;return!1}function A(t){return t.substring(0,x.length)===x}function O(t){I={};const e=0===Object.keys(t).length;e||function(t){Object.keys(t).forEach((function(e){I[e]=t[e]+""}))}(t),function(t){for(var e=a.length;e--;){var s=a.key(e);s&&A(s)&&(t&&T(E(s),a.getItem(s)),a.removeItem(s))}}(e)}r.on("settings",(function(t){var e=JSON.parse(t);null==e.value?delete I[e.key]:I[e.key]=e.value}));var F=new o;return document.addEventListener("visibilitychange",(function(){"hidden"!==document.visibilityState&&!0!==document.hidden||B()})),window.addEventListener("pagehide",(function(){B(!0)})),window.addEventListener("beforeunload",(function(){B(!0)})),u.subscribe(null,(()=>{B()})),{loaded:!1,loadedModel:!1,getValue:N,getJSON:function(t,e){var s=N(t,void 0);if(null==s)return e;try{return JSON.parse(s)}catch(s){return D(t),e}},getBool:function(t,e){var s=N(t);return null==s?e:!(!s||"false"===s||0==+s)},getFloat:function(t,e,s){var i=N(t,void 0);if(null==i)return e;var n=parseFloat(i);if(!isFinite(n))throw new TypeError('"'+i+'" is not float (key: "'+t+'")');return n},getInt:function(t,e,s){var i=N(t,void 0);if(null==i)return e;var n=parseInt(i,10);if(!isFinite(n))throw new TypeError('"'+i+'" is not int (key: "'+t+'")');return n},setValue:T,setJSON:function(t,e,s){return T(t,JSON.stringify(e),s),_},remove:D,keys:L,keysMask:function(t,e){for(var s=L(),i=[],r=(t=new RegExp("^"+n(t).replace(/\\\*\\\*/gi,".+").replace(/\\\*/gi,"[^.]+")+"$","gi"),s.length-1);r>=0;r--)t.test(s[r])&&i.push(s[r]),t.lastIndex=0;return i},sync:function(t){null!==t?(e?O(e.initialSettings||{}):m()?(function(){if(TradingView.onWidget()&&c.includes(window.location.host))for(var t="tradingview.",e=a.length;e--;){var s=a.key(e);if(0===s.indexOf(t)){var i=s.replace(t,S+".");a.setItem(i,a.getItem(s)),a.removeItem(s)}}}(),function(){I={};for(var t=!l.enabled("save_chart_properties_to_local_storage"),e=a.length;e--;){var s=a.key(e);if(s&&A(s)){var i=s.substring(x.length);t&&!$(i)||(I[i]=a.getItem(s))}}}()):O(t||{}),F.fire()):s=!0},onSync:F,setSettingsAdapter:function(t){e=t}}}());setTimeout((function(){s.e(30362).then(s.bind(s,276141)).then((t=>{t.clearOldSettings()}))}),3e4),t&&t.exports&&(t.exports=_)},226722:(t,e,s)=>{s.d(e,{TVXWindowEvents:()=>a});s(586463);var i=s(201089),n=s(49437);const r=(0,i.getLogger)("XWindowEvents");var a;!function(t){const e="tvxwevents.",s={};let i;window.BroadcastChannel?(i=new BroadcastChannel("tvxwevents"),i.addEventListener("message",(function(t){const{data:{event:e,value:i}}=t;s[e]&&s[e].forEach((t=>{t(i)}))})),function(){const t=[],s=performance.now();for(let s=0;s<n.TVLocalStorage.length;s++){const i=n.TVLocalStorage.key(s);i.startsWith(e)&&t.push(i)}const i=n.TVLocalStorage.length;for(const e of t)n.TVLocalStorage.removeItem(e);const a=performance.now()-s;r.logNormal(`Total keys amount in local storage on operation start: ${i}`),r.logNormal(`Keys amount in local storage to be deleted: ${t.length}`),
r.logNormal(`Keys to be deleted from local storage: ${JSON.stringify(t)}`),r.logNormal(`Removing keys from local storage took ${a} ms`)}()):window.addEventListener("storage",(function(t){const{newValue:i,key:r}=t;if(null===i||!r||!r.startsWith(e))return;const a=r.substring(e.length);s[a]&&s[a].forEach((e=>{e(t.newValue)}));n.TVLocalStorage.removeItem(r)})),t.on=function(t,e){s[t]||(s[t]=[]),s[t].push(e)},t.off=function(t,e){if(!s[t])return;const i=s[t].indexOf(e);-1!==i&&(1===s[t].length?delete s[t]:s[t].splice(i,1))},t.emit=function(t,s=Date.now()){try{i?i.postMessage({event:t,value:s}):n.TVLocalStorage.setItem(e+t,s.toString())}catch(t){r.logError(t.message)}}}(a||(a={}))},674981:(t,e,s)=>{s.d(e,{lowerbound:()=>i,upperbound:()=>n});s(650151);function i(t,e,s,i=0,n=t.length){return function(t,e,s,i,n){let r=n-i;for(;0<r;){const n=r>>1,a=i+n;s(t(a),e)?(i=a+1,r-=n+1):r=n}return i}((e=>t[e]),e,s,i,n)}function n(t,e,s,i=0,n=t.length){let r=n-i;for(;0<r;){const n=r>>1,a=i+n;s(e,t[a])?r=n:(i=a+1,r-=n+1)}return i}},919892:(t,e,s)=>{function i(t){return"="+JSON.stringify(n(t))}function n(t){return Object.keys(t).sort().reduce(((e,s)=>("[object Object]"===Object.prototype.toString.call(t[s])?e[s]=n(t[s]):e[s]=t[s],e)),{})}function r(t){return Boolean(t.inputs)||function(t){return Boolean(t.replay)}(t)||t.session||t.adjustment||t["currency-id"]||t["unit-id"]?i(t):t.symbol}s.d(e,{encodeExtendedSymbolOrGetSimpleSymbolString:()=>r})},551775:(t,e,s)=>{s.d(e,{customFormatters:()=>i});const i={dateFormatter:null,timeFormatter:null,tickMarkFormatter:null,priceFormatterFactory:null,studyFormatterFactory:null}},223699:(t,e,s)=>{s.d(e,{Interval:()=>u,ResolutionKind:()=>r});const i=/^(\d*)([TSHDWMR])$/,n=/^(\d+)$/;var r,a;!function(t){t.Ticks="ticks",t.Seconds="seconds",t.Minutes="minutes",t.Days="days",t.Weeks="weeks",t.Months="months",t.Range="range",t.Invalid="invalid"}(r||(r={})),function(t){t.Hours="hours"}(a||(a={}));const o={};o[r.Ticks]=1e3,o[r.Seconds]=1e3,o[r.Minutes]=60*o[r.Seconds],o[r.Days]=1440*o[r.Minutes],o[r.Weeks]=7*o[r.Days];const l={T:r.Ticks,S:r.Seconds,D:r.Days,W:r.Weeks,M:r.Months,R:r.Range},h=new Set([r.Ticks,r.Seconds,r.Minutes]);class u{constructor(t,e){this._kind=r.Invalid,this._multiplier=0,t!==r.Invalid&&e>0&&(this._kind=t,this._multiplier=e)}kind(){return this._kind}multiplier(){return this._multiplier}isValid(){return this.kind()!==r.Invalid&&this.multiplier()>0}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isIntraday(){const t=h.has(this.kind());return this.isValid()&&t}isSeconds(){return this.kind()===r.Seconds}isMinutes(){return this.kind()===r.Minutes}isMinuteHours(){return this.kind()===r.Minutes&&((t=this.multiplier())>=60&&!(t%60));var t}isDays(){return this.kind()===r.Days}isWeeks(){return this.kind()===r.Weeks}isMonths(){return this.kind()===r.Months}isRange(){return this.kind()===r.Range}isTicks(){return this.kind()===r.Ticks}isTimeBased(){return!this.isRange()}letter(){return this.isValid()&&this.kind()!==r.Minutes?this.kind()[0].toUpperCase():""}value(){
return this.isValid()?this.kind()===r.Minutes?this.multiplier()+"":this.multiplier()+this.letter():""}isEqualTo(t){if(!(t instanceof u))throw new Error("Argument is not an Interval");return!(!this.isValid()||!t.isValid())&&(this.kind()===t.kind()&&this.multiplier()===t.multiplier())}inMilliseconds(t=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const e=new Date(t);e.setUTCMonth(e.getUTCMonth()+(this.multiplier()||1));return+e-t}const e=this.multiplier();return o[this.kind()]*e}static isEqual(t,e){return t===e||u.parse(t).isEqualTo(u.parse(e))}static parseExt(t){t=(t+"").toUpperCase().split(",")[0];let e=i.exec(t);return null!==e?"H"===e[2]?{interval:new u(r.Minutes,60*d(e[1])),guiResolutionKind:a.Hours}:{interval:new u(l[e[2]],d(e[1])),guiResolutionKind:l[e[2]]}:(e=n.exec(t),null!==e?{interval:new u(r.Minutes,d(e[1])),guiResolutionKind:r.Minutes}:{interval:new u(r.Invalid,0),guiResolutionKind:r.Invalid})}static parse(t){return u.parseExt(t).interval}static kind(t){return u.parse(t).kind()}static isValid(t){return u.parse(t).isValid()}static isDWM(t){return u.parse(t).isDWM()}static isIntraday(t){return u.parse(t).isIntraday()}static isSeconds(t){return u.parse(t).isSeconds()}static isMinutes(t){return u.parse(t).isMinutes()}static isMinuteHours(t){return u.parse(t).isMinuteHours()}static isDays(t){return u.parse(t).isDays()}static isWeeks(t){return u.parse(t).isWeeks()}static isMonths(t){return u.parse(t).isMonths()}static isRange(t){return u.parse(t).isRange()}static isTicks(t){return u.parse(t).isTicks()}static isTimeBased(t){return u.parse(t).isTimeBased()}static normalize(t){const e=u.parse(t);return e.isValid()?e.value():null}}function d(t){return 0===t.length?1:parseInt(t,10)}},534741:(t,e,s)=>{var i;s.d(e,{PlotRowSearchMode:()=>i}),function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.Exact=0]="Exact",t[t.NearestRight=1]="NearestRight"}(i||(i={}))},178389:(t,e,s)=>{s.d(e,{unpackNonSeriesData:()=>r});var i=s(130551),n=s(133822);async function r(t){if(""===t)return null;const e=JSON.parse(t);if(!(0,i.isObject)(e)||"function"==typeof e)throw new Error("Non-object content in the non-series envelope");if((0,i.hasProperty)(e,"indexes_replace"))return{indexes_replace:!0};const r={indexes_replace:!1};if((0,i.hasProperty)(e,"offsets")&&(r.offsets=e.offsets),(0,i.hasProperty)(e,"isUpdate")){if("boolean"!=typeof e.isUpdate)throw new Error('Invalid type of "isUpdate" field');r.isUpdate=e.isUpdate}if((0,i.hasProperty)(e,"data")&&(r.data=e.data),(0,i.hasProperty)(e,"graphicsCmds")&&(r.graphicsCmds=(0,n.validateGraphicsCommands)(e.graphicsCmds)),(0,i.hasProperty)(e,"dataCompressed")||(0,i.hasProperty)(e,"graphicsCmdsCompressed")){const{default:t}=await Promise.all([s.e(93194),s.e(81578)]).then(s.t.bind(s,593194,23));if((0,i.hasProperty)(e,"dataCompressed")){const s=await(new t).loadAsync(e.dataCompressed,{base64:!0});r.data=JSON.parse(await s.file("").async("text"))}if((0,i.hasProperty)(e,"graphicsCmdsCompressed")){const s=await(new t).loadAsync(e.graphicsCmdsCompressed,{base64:!0})
;r.graphicsCmds=(0,n.validateGraphicsCommands)(JSON.parse(await s.file("").async("text")))}return r}return r}},195447:(t,e,s)=>{s.d(e,{PlotList:()=>c});var i=s(650151),n=s(674981),r=s(732149),a=s(201089),o=s(534741);const l=(0,a.getLogger)("Chart.PlotList"),h=30;function u(t){return t.index}function d(t){return t.value[0]}class c{constructor(t=null,e=null){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache=new Map,this._rowSearchCacheByIndex=new Map,this._rowSearchCacheByIndexWithoutEmptyValues=new Map,this._rowSearchCacheByTime=new Map,this._rowSearchCacheByTimeWithoutEmptyValues=new Map,this._plotFunctions=t||new Map,this._emptyValuePredicate=e}clear(){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache.clear(),this._invalidateSearchCaches()}first(){return this.size()>0?this._items[this._start]:null}last(){return this.size()>0?this._items[this._end-1]:null}firstIndex(){return this.size()>0?this._indexAt(this._start):null}lastIndex(){return this.size()>0?this._indexAt(this._end-1):null}size(){return this._end-this._start}isEmpty(){return 0===this.size()}contains(t){return null!==this.search(t,o.PlotRowSearchMode.Exact)}valueAt(t){const e=this.search(t);return null!==e?e.value:null}add(t,e){if(this._shareRead)return l.logDebug("add: readonly collection modification attempt"),!1;const s={index:t,value:e},i=this._nonCachedSearch(t,o.PlotRowSearchMode.Exact,u);return this._invalidateSearchCaches(),null===i?(this._items.splice(this._lowerbound(t,u),0,s),this._start=0,this._end=this._items.length,!0):(this._items[i]=s,!1)}search(t,e=o.PlotRowSearchMode.Exact,s){return this._searchImpl(t,e,this._rowSearchCacheByIndex,this._rowSearchCacheByIndexWithoutEmptyValues,u,s)}searchByTime(t,e=o.PlotRowSearchMode.Exact,s){return this._searchImpl(t,e,this._rowSearchCacheByTime,this._rowSearchCacheByTimeWithoutEmptyValues,d,s)}fold(t,e){let s=e;for(let e=this._start;e<this._end;++e){s=t(this._indexAt(e),this._valueAt(e),s)}return s}findFirst(t,e){const s=void 0!==e&&Math.min(this._start+e,this._end)||this._end;for(let e=this._start;e<s;++e){const s=this._indexAt(e),i=this._valueAt(e);if(t(s,i))return{index:s,value:i}}return null}findLast(t,e){const s=void 0!==e&&Math.max(this._end-e,this._start)||this._start;for(let e=this._end-1;e>=s;--e){const s=this._indexAt(e),i=this._valueAt(e);if(t(s,i))return{index:s,value:i}}return null}each(t){for(let e=this._start;e<this._end;++e){if(t(this._indexAt(e),this._valueAt(e)))break}}reduce(t,e){let s=e;for(let e=this._start;e<this._end;++e){s=t(s,this._indexAt(e),this._valueAt(e))}return s}range(t,e){const s=new c(this._plotFunctions,this._emptyValuePredicate);return s._items=this._items,s._start=this._lowerbound(t,u),s._end=this._upperbound(e),s._shareRead=!0,s}plottableRange(t){const e=new c(this._plotFunctions,this._emptyValuePredicate);return e._items=this._items,e._start=this._upperbound(r.UNPLOTTABLE_TIME_POINT_INDEX),e._end=this._end,e._shareRead=!0,!0===t&&e._start>this._start&&(e._start-=1),e}rangeIterator(t,e){
const s=this._lowerbound(t,u),i=this._upperbound(e);return this._rangeIteratorImpl(s,i)}fullRangeIterator(){return this._rangeIteratorImpl(this._start,this._end)}minMaxOnRangeCached(t,e,s){if(this.isEmpty())return null;let i=null;for(const n of s){i=_(i,this._minMaxOnRangeCachedImpl(t-n.offset,e-n.offset,n.name))}return i}minMaxOnRange(t,e,s){if(this.isEmpty())return null;let i=null;for(const n of s){i=_(i,this._minMaxOnRange(t-n.offset,e-n.offset,n.name))}return i}merge(t){return this._shareRead?(l.logDebug("merge: readonly collection modification attempt"),null):0===t.length?null:this.isEmpty()||t[t.length-1].index<this._items[0].index?this._prepend(t):t[0].index>this._items[this._items.length-1].index?this._append(t):1===t.length&&t[0].index===this._items[this._items.length-1].index?(this._updateLast(t[0]),t[0]):this._merge(t)}addTail(t,e=!1){if(0===t.length)return;let s=0;e&&this._end-this._start>0&&(s=1,this._items[this._end-this._start-1].value=t[0].value);for(let e=s;e<t.length;++e){const s=t[e],i=this.lastIndex();if(null===i){l.logError("Can't add tail to the empty plotlist");break}this.add(i+1,s.value)}this._invalidateSearchCaches()}move(t){if(this._shareRead)return void l.logDebug("move: readonly collection modification attempt");if(0===t.length)return;const e=this._items.slice();for(const s of t){const t=this._bsearch(s.old,u);if(null!==t&&void 0!==e[t])if(s.new===r.INVALID_TIME_POINT_INDEX)e[t]=void 0;else{e[t]={index:s.new,value:e[t].value};const i=this._bsearch(s.new,u);if(null!==i){const t=e[i];void 0!==t&&t.index===s.new&&(e[i]=void 0)}}}this._items=e.filter((t=>void 0!==t)).sort(((t,e)=>t.index-e.index)),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._start=0,this._end=this._items.length}remove(t){if(this._shareRead)return l.logDebug("remove: readonly collection modification attempt"),null;const e=this._nonCachedSearch(t,o.PlotRowSearchMode.NearestRight,u);if(null===e)return null;const s=this._items.splice(e);return this._end=this._items.length,this._minMaxCache.clear(),this._invalidateSearchCaches(),s.length>0?s[0]:null}state(){const t=this._items.slice(this._start,this._end);return{start:0,end:t.length,data:t}}restoreState(t){t?(this._start=t.start,this._end=t.end,this._shareRead=!1,this._items=t.data,this._minMaxCache.clear(),this._invalidateSearchCaches()):this.clear()}_indexAt(t){return this._items[t].index}_valueAt(t){return this._items[t].value}_length(){return this._items.length}_searchImpl(t,e,s,i,n,r){const a=void 0!==r?s:i,o=void 0!==r?1e4*(e+1)+r:e;let l=a.get(t);if(void 0!==l){const t=l.get(o);if(void 0!==t)return t}const h=this._nonCachedSearch(t,e,n,r);if(null===h)return null;const u={index:this._indexAt(h),value:this._valueAt(h)};return void 0===l&&(l=new Map,a.set(t,l)),l.set(o,u),u}_nonCachedSearch(t,e,s,i){const n=this._lowerbound(t,s),r=n===this._end||t!==s(this._items[n]);if(r&&e!==o.PlotRowSearchMode.Exact)switch(e){case o.PlotRowSearchMode.NearestLeft:return this._searchNearestLeft(n,i);case o.PlotRowSearchMode.NearestRight:return this._searchNearestRight(n,i)
;default:throw new TypeError("Unknown search mode")}if(void 0===i||r||e===o.PlotRowSearchMode.Exact)return r?null:n;switch(e){case o.PlotRowSearchMode.NearestLeft:return this._nonEmptyNearestLeft(n,i);case o.PlotRowSearchMode.NearestRight:return this._nonEmptyNearestRight(n,i);default:throw new TypeError("Unknown search mode")}}_nonEmptyNearestRight(t,e){const s=(0,i.ensure)(this._emptyValuePredicate),n=(0,i.ensure)(e);for(;t<this._end&&s(this._valueAt(t),n);)t+=1;return t===this._end?null:t}_nonEmptyNearestLeft(t,e){const s=(0,i.ensureNotNull)(this._emptyValuePredicate),n=(0,i.ensure)(e);for(;t>=this._start&&s(this._valueAt(t),n);)t-=1;return t<this._start?null:t}_searchNearestLeft(t,e){if(t===this._start)return null;const s=t-1,i=s!==this._end?s:null;return void 0!==e&&null!==i?this._nonEmptyNearestLeft(i,e):i}_searchNearestRight(t,e){const s=t,i=s!==this._end?s:null;return void 0!==e&&null!==i?this._nonEmptyNearestRight(i,e):i}_bsearch(t,e){const s=this._lowerbound(t,e);return s!==this._end&&t===e(this._items[s])?s:null}_lowerbound(t,e){return(0,n.lowerbound)(this._items,t,((t,s)=>e(t)<s),this._start,this._end)}_upperbound(t){return(0,n.upperbound)(this._items,t,((t,e)=>e.index>t),this._start,this._end)}_plotMinMax(t,e,s){let i=null;const n=this._plotFunctions.get(s);if(void 0===n)throw new Error(`Plot "${s}" is not registered`);for(let s=t;s<e;s++){const t=n(this._items[s].value);null==t||Number.isNaN(t)||(null===i?i={min:t,max:t}:(t<i.min&&(i.min=t),t>i.max&&(i.max=t)))}return i}_invalidateCacheForRow(t){const e=Math.floor(t.index/h);this._minMaxCache.forEach((t=>t.delete(e)))}_prepend(t){return(0,i.assert)(!this._shareRead,"collection should not be readonly"),(0,i.assert)(0!==t.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=t.concat(this._items),this._start=0,this._end=this._items.length,t[0]}_append(t){return(0,i.assert)(!this._shareRead,"collection should not be readonly"),(0,i.assert)(0!==t.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=this._items.concat(t),this._start=0,this._end=this._items.length,t[0]}_updateLast(t){(0,i.assert)(!this.isEmpty(),"plot list should not be empty");const e=this._items[this._end-1];(0,i.assert)(e.index===t.index,"last row index should match new row index"),this._invalidateCacheForRow(t),this._invalidateSearchCaches(),this._items[this._end-1]=t}_merge(t){return(0,i.assert)(0!==t.length,"plot rows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=function(t,e){const s=function(t,e){const s=t.length,i=e.length;let n=s+i,r=0,a=0;for(;r<s&&a<i;)t[r].index<e[a].index?r++:t[r].index>e[a].index?a++:(r++,a++,n--);return n}(t,e),i=new Array(s);let n=0,r=0;const a=t.length,o=e.length;let l=0;for(;n<a&&r<o;)t[n].index<e[r].index?(i[l]=t[n],n++):t[n].index>e[r].index?(i[l]=e[r],r++):(i[l]=e[r],n++,r++),l++;for(;n<a;)i[l]=t[n],n++,l++;for(;r<o;)i[l]=e[r],r++,l++;return i}(this._items,t),this._start=0,this._end=this._items.length,
t[0]}_minMaxOnRangeCachedImpl(t,e,s){if(this.isEmpty())return null;let n=null;const r=(0,i.ensureNotNull)(this.firstIndex()),a=(0,i.ensureNotNull)(this.lastIndex()),o=Math.max(t,r),l=Math.min(e,a),u=Math.ceil(o/h)*h,d=Math.max(u,Math.floor(l/h)*h);n=_(n,this._minMaxOnRange(o,Math.min(u,e,l),s));let c=this._minMaxCache.get(s);void 0===c&&(c=new Map,this._minMaxCache.set(s,c));for(let t=Math.max(u+1,o);t<d;t+=h){const e=Math.floor(t/h);let i=c.get(e);if(void 0===i){const t=e*h,n=(e+1)*h-1;i=this._minMaxOnRange(t,n,s),c.set(e,i)}n=_(n,i)}n=_(n,this._minMaxOnRange(d,l,s));return n}_minMaxOnRange(t,e,s){return this._plotMinMax(this._lowerbound(t,u),this._upperbound(e),s)}_rangeIteratorImpl(t,e){let s=t-1;return{[Symbol.iterator](){return this},next:()=>(s+=1,s>=e?{done:!0,value:void 0}:{done:!1,value:this._items[s]})}}_invalidateSearchCaches(){this._rowSearchCacheByIndex.clear(),this._rowSearchCacheByIndexWithoutEmptyValues.clear(),this._rowSearchCacheByTime.clear(),this._rowSearchCacheByTimeWithoutEmptyValues.clear()}}function _(t,e){if(null===t)return e;if(null===e)return t;return{min:Math.min(t.min,e.min),max:Math.max(t.max,e.max)}}},824837:(t,e,s)=>{s(401580)},339315:(t,e,s)=>{},544421:(t,e,s)=>{s.d(e,{SeriesData:()=>c});var i,n=s(650151),r=s(195447),a=s(674981);!function(t){t[t.FromLeft=-1]="FromLeft",t[t.FromRight=1]="FromRight"}(i||(i={}));const o={open:t=>t[1],high:t=>t[2],low:t=>t[3],close:t=>t[4],hl2:t=>(t[2]+t[3])/2,hlc3:t=>(t[2]+t[3]+t[4])/3,ohlc4:t=>(t[1]+t[2]+t[3]+t[4])/4},l=["open","high","low","close","hl2","hlc3","ohlc4"];function h(){const t=new Map;return l.forEach(((e,s)=>{t.set(e,function(t,e,s){const i=o[null!=e?e:t],n=o[t],r=o[null!=s?s:t];return(t,e)=>{switch(e){case 0:return i(t);case 2:return r(t);default:return n(t)}}}(e))})),t}function u(t,e){return null==t[e]}const d=[{barsToMerge:10,forBarspacingLargerThen:.03},{barsToMerge:30,forBarspacingLargerThen:.01},{barsToMerge:100,forBarspacingLargerThen:.003},{barsToMerge:500,forBarspacingLargerThen:0}];class c{constructor(){this._pressedChunks={chunks:new Map,priceSource:"uninitialized"},this.m_bars=new r.PlotList(h(),u),this.m_nsBars=new r.PlotList(h(),u),this._clearPressedChunks()}bars(){return this.m_bars}nsBars(){return this.m_nsBars}pressedChunks(t,e){if(e!==this._pressedChunks.priceSource){this._pressedChunks.priceSource=e;const t=this.m_bars.first();t&&(this._clearPressedChunks(),this._rebuildPressedChunks(t))}const s=(0,n.ensureDefined)(d.find((e=>e.forBarspacingLargerThen<=t)));return(0,n.ensureDefined)(this._pressedChunks.chunks.get(s.barsToMerge))}mergeRegularBars(t){const e=this.m_bars.size(),s=this.m_bars.merge(t);return s&&"uninitialized"!==this._pressedChunks.priceSource&&(e===this.m_bars.size()&&s.index===this.m_bars.lastIndex()?this._updateLatestChunks():this._rebuildPressedChunks(s)),s}size(){return this.m_bars.size()+this.m_nsBars.size()}each(t){this.m_bars.each(t),this.m_nsBars.each(t)}clear(){this.m_bars.clear(),this.m_nsBars.clear(),this.lastProjectionPrice=void 0,this._clearPressedChunks()}isEmpty(){
return this.m_bars.isEmpty()&&this.m_nsBars.isEmpty()}first(){return this.m_bars.isEmpty()?this.m_nsBars.first():this.m_bars.first()}last(){return this.m_nsBars.isEmpty()?this.m_bars.last():this.m_nsBars.last()}search(t,e){return this.nsBars().isEmpty()?this.bars().search(t,e):this.bars().isEmpty()||(0,n.ensureNotNull)(this.nsBars().firstIndex())<=t?this.nsBars().search(t,e):this.bars().search(t,e)}valueAt(t){const e=this.search(t);return null!==e?e.value:null}plotValueToTimePointIndex(t,e,s){if(s===i.FromRight){const s=(s,i)=>{const n=i[e];return null!=n&&t>=n},i=this.m_bars.findLast(s);if(null!==i)return i.index;const n=this.m_nsBars.findLast(s);return null!==n?n.index:this.m_bars.firstIndex()}if(s===i.FromLeft){const s=(s,i)=>{const n=i[e];return null!=n&&t<=n},i=this.m_bars.findFirst(s);if(null!==i)return i.index;const n=this.m_nsBars.findFirst(s);return null!==n?n.index:this.m_bars.lastIndex()}throw new Error("plotValueToTimePointIndex: unsupported search mode")}moveData(t){this.m_bars.move(t),this.m_nsBars.move(t),this.m_bars.size()>0&&this._rebuildPressedChunks((0,n.ensureNotNull)(this.m_bars.first()))}_rebuildPressedChunks(t){const e=this._pressedChunks.priceSource;if("uninitialized"===e)return;const s=t.index,i=o[e],r=(t,e,s)=>{let n=null;for(const r of t){const t=i(r.value);n&&r.index-n.startTime>=s.barsToMerge&&(e.push(n),n=null),n?(n.endTime=r.index,n.high=Math.max(n.high,t),n.low=Math.min(n.low,t),n.close=t):n={startTime:r.index,endTime:r.index,open:t,high:t,low:t,close:t}}n&&e.push(n)};d.forEach((t=>{const e=(0,n.ensureDefined)(this._pressedChunks.chunks.get(t.barsToMerge)),i=(0,a.lowerbound)(e,s,((t,e)=>t.endTime<e));if(0===i&&e.length>0){const s=e[0].startTime-1,i=(0,n.ensureNotNull)(this.m_bars.firstIndex()),a=this.m_bars.rangeIterator(i,s),o=[];r(a,o,t);const l=o.concat(e);this._pressedChunks.chunks.set(t.barsToMerge,l)}else{const s=(0,n.ensureNotNull)(this.m_bars.lastIndex());e.splice(i);let a=(0,n.ensureNotNull)(this.m_bars.firstIndex());e.length&&(a=e[e.length-1].endTime+1);const o=this.m_bars.rangeIterator(a,s);r(o,e,t)}}))}_updateLatestChunks(){const t=(0,n.ensureNotNull)(this.m_bars.last());d.forEach((e=>{const s=(0,n.ensureDefined)(this._pressedChunks.chunks.get(e.barsToMerge)),i=t.value[4],r=s[s.length-1];r.high=Math.max(r.high,i),r.low=Math.min(r.low,i),r.close=i,r.endTime=t.index}))}_clearPressedChunks(){d.forEach((t=>this._pressedChunks.chunks.set(t.barsToMerge,[])))}}},175878:(t,e,s)=>{s.d(e,{SeriesDataSource:()=>v});var i=s(650151),n=s(389137),r=s(919892),a=s(223699),o=s(544421),l=s(178389),h=s(826989),u=s(442410),d=s(201089),c=s(444331);const _=(0,d.getLogger)("Chart.SeriesDataSource");var m;!function(t){t[t.Idle=0]="Idle",t[t.AwaitingConnection=1]="AwaitingConnection",t[t.AwaitingFirstDataUpdate=2]="AwaitingFirstDataUpdate",t[t.Active=3]="Active"}(m||(m={}));let g=1;let p=1;function f(t){return t.startDate?t.endDate||t.count?t.endDate?["from_to",t.startDate,t.endDate]:["bar_count",t.startDate,(0,i.ensure)(t.count)]:["from_to",t.startDate]:t.count||300}class v{constructor(t,e,s,i){
this._symbol=null,this._resolvedSymbolName=null,this._createSeriesOverriddenParams=0,this._instanceId=null,this._symbolInstanceId=null,this._resolution=null,this._timeFrame=null,this._data=new o.SeriesData,this._dataEvents=new u.SeriesDataEvents,this._status=m.Idle,this._turnaroundCounter=1,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=t,this._turnaroundPrefix=e,this._createSeriesParams=f(null!=s?s:{count:300}),this._timeFrame=i||null,this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged)}modifySeries(t,e,s=null,r=!1,o=null){r&&(_.logNormal("Due to force flag clearing symbol & resolution to force re-requesting data."),this._symbol=null,this._resolution=null);const l=this._symbol,h=this._resolution;if(this._symbol=t,this._resolution=e,null===this._instanceId)return void(this._timeFrame=s);const u=!(0,n.deepEquals)(l,t)[0]||null!==this._resolvedSymbolName&&this._resolvedSymbolName!==this._getSymbolNameString(t),d=null===h||!a.Interval.isEqual(h,e);(u||d||null!==s)&&(this._timeFrame=null,(u||d)&&this._turnaroundCounter++,u&&this._resolveSymbol(),this._gateway.modifySeries(this._instanceId,this.turnaround(),(0,i.ensureNotNull)(this._symbolInstanceId),this._resolution,o,s,this._onMessage.bind(this)),this._dataEvents.fireModified())}requestMoreData(t){null!==this._instanceId&&this._gateway.requestMoreData(this._instanceId,t,this._onMessage.bind(this))}requestMoreTickmarks(t){null!==this._instanceId&&this._gateway.requestMoreTickmarks(this._instanceId,t,this._onMessage.bind(this))}isStarted(){return this._status!==m.Idle}isActive(){return this._status===m.Active}resolution(){return this._resolution}start(){this.isStarted()?_.logNormal("start: data source is already started, nothing to do"):((0,i.assert)(null!==this._symbol,"symbol must be set before start"),(0,i.assert)(null!==this._resolution,"resolution must be set before start"),this._gateway.isConnected().value()?this._createSeries():this._changeStatusTo(m.AwaitingConnection))}stop(){this.isStarted()?(null!==this._instanceId&&(this._gateway.removeSeries(this._instanceId),this._instanceId=null),this._changeStatusTo(m.Idle)):_.logNormal("stop: data source is already stopped, nothing to do")}instanceId(){return this._instanceId}data(){return this._data}clearData(){this.isStarted()?this._enqueueUpdate((()=>this._clearDataImpl())):this._clearDataImpl()}dataEvents(){return this._dataEvents}turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}symbolInstanceId(){return this._symbolInstanceId}symbol(){return this._symbol}moveData(t){this._enqueueUpdate((()=>this._data.moveData(t)))}setInitialRequestOptions(t){this._createSeriesOverriddenParams=f(t)}_resolveSymbol(){null!==this._symbol&&(this._symbolInstanceId=this._gateway.resolveSymbol("sds_sym_"+g++,(0,r.encodeExtendedSymbolOrGetSimpleSymbolString)(this._symbol),this._onMessage.bind(this)))}
_clearDataImpl(){this._data.clear()}_changeStatusTo(t){(0,i.assert)(this._status!==t,"Source and destination status should be distinct"),_.logNormal(`Status changed from ${m[this._status]} to ${m[t]}`),this._status=t}_createSeries(){(0,i.assert)(this._status!==m.Active,'Status should not be "Active" when creating a study'),this._instanceId="sds_"+p++,this._resolveSymbol();const t=this._createSeriesOverriddenParams||this._createSeriesParams;this._createSeriesOverriddenParams&&(this._createSeriesOverriddenParams=0),this._gateway.createSeries(this._instanceId,this.turnaround(),(0,i.ensureNotNull)(this._symbolInstanceId),(0,i.ensureNotNull)(this._resolution),t,this._timeFrame,this._onMessage.bind(this)),this._timeFrame=null,this._changeStatusTo(m.AwaitingFirstDataUpdate),this._dataEvents.fireCreated(this._instanceId)}_onGatewayIsConnectedChanged(t){t?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===m.AwaitingConnection&&this._createSeries()}_onGatewayDisconnected(){this._status!==m.Idle&&this._status!==m.AwaitingConnection&&(this._instanceId=null,this._changeStatusTo(m.AwaitingConnection)),this._turnaroundCounter=1}_onMessage(t){this._enqueueUpdate((()=>this._onMessageImpl(t)))}async _onMessageImpl(t){switch(t.method){case"symbol_resolved":{const[e,s]=t.params;if(e!==this._symbolInstanceId){_.logNormal(`Resolve for old symbol, expected: ${this._symbolInstanceId}, actual ${t.params[0]}`);break}this._onSymbolResolved(s);break}case"symbol_error":if(t.params[0]!==this._symbolInstanceId){_.logNormal(`Symbol error for old symbol, expected: ${this._symbolInstanceId}, actual ${t.params[0]}`);break}this._onSymbolError(t);break;case"series_timeframe":{const[e,s,i,n,r,a,o]=t.params;if(!this._checkTurnaround(e,s)){_.logNormal(`Time frame for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${s})`);break}this._onSeriesTimeFrame(i,n,r,a,o);break}case"series_error":{const[e,s]=t.params;if(!this._checkTurnaround(e,s)){_.logNormal(`Series error for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${s})`);break}this._onSeriesError(t.params[2]);break}case"series_loading":{const[e,s]=t.params;if(!this._checkTurnaround(e,s))break;this._onSeriesLoading(t.time);break}case"series_completed":{const[e,s,i,n]=t.params;if(!this._checkTurnaround(e,i)){_.logNormal(`Series completed for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${i})`);break}this._onSeriesCompleted(s,t.time,n);break}case"data_update":if(!this._checkTurnaround(t.params.customId,t.params.turnaround)){_.logNormal(`Data update for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${t.params.customId} (${t.params.turnaround})`);break}await this._onDataUpdate(t.params.plots,t.params.nonseries,t.params.lastBar);break;case"clear_data":if(t.params.turnaround!==this.turnaround()){_.logNormal(`Clear data for old data, expected: ${this.turnaround()}, actual ${t.params.turnaround}`);break}this._clearDataImpl(),
this._dataEvents.fireDataUpdated(void 0,!1,null)}}_onSeriesError(t){let e,s;if("string"==typeof t)s={error:t},e=t;else if(s=t,t.ctx){const s={};Object.entries(t.ctx).forEach((([t,e])=>{s[t]=e.toString()})),e=t.error.format(s)}else e=t.error;if(e.startsWith("study_not_auth:")){const t=e.split(":",2)[1].split("@",2)[0];if(["BarSetRenko","BarSetPriceBreak","BarSetKagi","BarSetPnF"].includes(t))this._dataEvents.fireChartTypeNotPermitted(t);else if("BarSetSpread"===t)this._dataEvents.fireIntradaySpreadNotPermitted();else if("BarSetRange"===t){const t=`${(0,i.ensureNotNull)(this._symbol).inputs.range}R`;this._dataEvents.fireCustomIntervalNotPermitted(t)}}else"resolution_not_entitled"===e?this._dataEvents.fireIntradayExchangeNotPermitted():"custom_resolution"===e?this._dataEvents.fireCustomIntervalNotPermitted((0,i.ensureNotNull)(this._resolution)):"seconds_not_entitled"===e&&this._dataEvents.fireSecondsIntervalNotPermitted();this._dataEvents.fireSeriesError(s)}_onSeriesTimeFrame(t,e,s,i,n){this._dataEvents.fireSeriesTimeFrame(t,e,s,null==i||i,n)}_onSymbolError(t){if(t.params[1]===h.permissionDenied)switch(t.params[2]){case h.SymbolErrorPermissionDeniedReason.Symbol:this._dataEvents.fireSymbolNotPermitted(t.params[3]);break;case h.SymbolErrorPermissionDeniedReason.GroupPermission:this._dataEvents.fireSymbolGroupNotPermitted(t.params[3]);break;default:this._dataEvents.fireSymbolNotPermitted(t.params[2])}else t.params[1]===h.invalidSymbol&&this._dataEvents.fireSymbolInvalid();this._dataEvents.fireSymbolError(t.params[1])}_onSymbolResolved(t){this._resolvedSymbolName=(0,c.symbolForApi)(t,this._getSymbolNameString((0,i.ensureNotNull)(this._symbol))),this._dataEvents.fireSymbolResolved(t)}_getSymbolNameString(t){return"string"==typeof t.symbol?t.symbol:t.symbol.symbol}async _onDataUpdate(t,e,s){this._onDataUnpacked(t,s,await async function(t){if(void 0===t)return{projectionPlots:[],boxSize:null};if(""===t.d||"nochange"===t.indexes)return null;const e=await(0,l.unpackNonSeriesData)(t.d);if(null===e||e.indexes_replace)return null;const s=t.indexes,{bars:i,price:n,boxSize:r,reversalAmount:a}=e.data,o=(i||[]).map((t=>{let e;return"factor"in t?e=t.factor:"additionalPrice"in t&&(e=t.additionalPrice),{index:s[t.time],value:[0,t.open,t.high,t.low,t.close,t.volume,e]}}));return{lastPrice:n,projectionPlots:o,reversalAmount:a,boxSize:r}}(e))}_enqueueUpdate(t){return this._ongoingDataUpdate=this._ongoingDataUpdate.then(t,t),this._ongoingDataUpdate}_onDataUnpacked(t,e,s){if(this._status===m.Idle)return;this._status===m.AwaitingFirstDataUpdate&&(this._changeStatusTo(m.Active),this._clearDataImpl());const i=this._data.bars().size(),n=this._data.bars().firstIndex(),r=this._data.mergeRegularBars(t);null!==s&&(this._data.nsBars().clear(),this._data.nsBars().merge(s.projectionPlots),this._data.lastProjectionPrice=s.lastPrice,null!==s.boxSize&&(this._data.boxSize=s.boxSize),this._data.reversalAmount=s.reversalAmount);const a=null===n||null!==r&&r.index<n;this._dataEvents.fireDataUpdated(e,a,r),
i!==this._data.bars().size()&&null!==r&&this._dataEvents.fireBarReceived(r)}_onSeriesLoading(t){this._dataEvents.fireLoading(t)}_onSeriesCompleted(t,e,s){this._dataEvents.fireCompleted({updateMode:t,time:e,flags:s})}_checkTurnaround(t,e){return this._instanceId===t&&(void 0===e||e===this.turnaround())}}},868073:(t,e,s)=>{function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}s.d(e,{regExpEscape:()=>i})},146585:(t,e,s)=>{s.d(e,{daysStringLiteral:()=>n,monthsStringLiteral:()=>a,stringAsResolution:()=>l,weeksStringLiteral:()=>r,yearsStringLiteral:()=>o});var i=s(444372);const n=t=>i.t(null,{plural:"{str} days",count:t,replace:{str:`${t}`}},s(774262)),r=t=>i.t(null,{plural:"{str} weeks",count:t,replace:{str:`${t}`}},s(14074)),a=t=>i.t(null,{plural:"{str} months",count:t,replace:{str:`${t}`}},s(128039)),o=t=>i.t(null,{plural:"{str} years",count:t,replace:{str:`${t}`}},s(408222)),l=t=>t}}]);